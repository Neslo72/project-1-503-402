{# Note -- these were largely generated by chatGPT #}
{% macro tagOptions(tags) %}

{% set all_tags = [
"air-fryer", "appetizer", "baking", "beef", "bread", "breakfast",
"brunch", "budget", "chicken", "classic", "comfort", "dairy-free",
"dessert", "dinner", "easy", "family-friendly", "fresh", "gluten-free",
"grilling", "healthy", "high-protein", "holiday", "instant-pot",
"kid-friendly", "lunch", "low-carb", "main-course", "meal-prep",
"modern", "one-pot", "pasta", "pork", "quick", "rice", "salad",
"seafood", "side-dish", "slow-cooker", "snack", "soup", "spicy",
"summer", "vegan", "vegetarian", "winter"
] %}

{% for tag in all_tags %}
<div id="{{ tag }}" class="tag-item {% if tag in tags %}tag-select{% endif %}">
    {{ tag.replace('-', ' ').title() }}
</div>
{% endfor %}

{% endmacro %}


{% macro recipeCard(recipe) %}
<article class="recipe-card" data-url="{{ url_for('recipe', id=recipe.recipeid) }}">
   <div class="card-image">
      <img src="{{ recipe.image_url }}" alt="{{ recipe.title }}">
   </div>
   <div class="card-content">
      <h3 class="card-title">{{ recipe.title }}</h3>
      <p class="card-author">by {{ recipe.author }}</p>
      <div class="card-meta-row">
         {# Average rating display: "4.2 ★" or "No ratings yet" #}
         {% set avg = (recipe.avg_rating if recipe.avg_rating is not none else recipe.rating) %}
         <div class="card-rating" aria-label="{{ (avg or 0)|float|round(1) }} out of 5">
            {% if not avg or avg == 0 %}
            No ratings yet
            {% else %}
            {{ (avg)|float|round(1) }} ★
            {% endif %}
         </div>
         {# Save chip (bookmark) — unified across pages #}
         <button
            class="save-chip {% if recipe.is_saved %}is-saved{% endif %}"
            type="button"
            data-recipe-id="{{ recipe.recipeid }}"
            data-saved="{{ 'true' if recipe.is_saved else 'false' }}"
            aria-pressed="{{ 'true' if recipe.is_saved else 'false' }}"
            >
            <span class="icon" aria-hidden="true">
               <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
               </svg>
            </span>
            <span class="label">{{ 'Saved' if recipe.is_saved else 'Save' }}</span>
         </button>
      </div>
      <p class="card-description">{{ recipe.brief }}</p>
      {#{% if recipe.tags %}
      <div class="tag-list" id="tagList">
         {% for tag in recipe.tags %}
         <button type="button" class="tag-btn" data-tag="{{ tag }}" onclick="event.stopPropagation();">
         {{ tag }}
         </button>
         {% endfor %}
      </div>
      {% endif %}#}
      
   </div>
</article>

{% endmacro %}


{% macro nutritionalLabel(nutrition, servings) %}

{% set nutrition = nutrition if nutrition is defined else ['--'] * 15 %}
{% set nutrition = nutrition | map('default', '--') | list %}
{% set servings = 1 if servings is not defined %}


<div id="nutrition-label" class="nutrition-label">
    <h2>Nutritional Estimate</h2>
    <p id="nut-servings">Total Servings: {{servings}}</p>
    <p>Calories per Serving: <span id="nut-0">{{nutrition[0]}}</span></p>
    <hr>
    <div class="nutrient"><strong>Protein:</strong> <span id="nut-1">{{nutrition[1]}} g</span></div>
    <div class="nutrient"><strong>Total Fat:</strong> <span id="nut-2">{{nutrition[2]}} g</span></div>
    <div class="nutrient indent">Saturated Fat: <span id="nut-14">{{nutrition[14]}} g</span></div>
    <div class="nutrient indent">Trans Fat: <span id="nut-13">{{nutrition[13]}} g</span></div>
    <div class="nutrient"><strong>Cholesterol:</strong> <span id="nut-12">{{nutrition[12]}} mg</span></div>
    <div class="nutrient"><strong>Sodium:</strong> <span id="nut-9">{{nutrition[9]}} mg</span></div>
    <div class="nutrient"><strong>Carbohydrates:</strong> <span id="nut-3">{{nutrition[3]}} g</span></div>
    <div class="nutrient indent">Sugars: <span id="nut-5">{{nutrition[5]}} g</span></div>
    <div class="nutrient indent">Fiber: <span id="nut-4">{{nutrition[4]}} g</span></div>
    <div class="nutrient"><strong>Calcium:</strong> <span id="nut-6">{{nutrition[6]}} mg</span></div>
    <div class="nutrient"><strong>Iron:</strong> <span id="nut-7">{{nutrition[7]}} mg</span></div>
    <div class="nutrient"><strong>Potassium:</strong> <span id="nut-8">{{nutrition[8]}} mg</span></div>
    <div class="nutrient"><strong>Vitamin A:</strong> <span id="nut-10">{{nutrition[10]}} µg</span></div>
    <div class="nutrient"><strong>Vitamin C:</strong> <span id="nut-11">{{nutrition[11]}} mg</span></div>
    <hr>
    <p>** Nutrient information may not consider all listed ingredients</p>
    <p>** Nutrient amounts are estimated by matching ingredients to foods in the 
        <a href="https://fdc.nal.usda.gov/">USDA food central database.</a>  
        Matchings may not be representative of ingredient realities
    </p>
</div>

{% endmacro %}


{% macro mmOptions() %}
<option value="tsp">teaspoon</option>
<option value="tbsp">tablespoon</option>
<option value="fl oz">fluid ounce</option>
<option value="cup">cup</option>
<option value="pt">pint</option>
<option value="qt">quart</option>
<option value="gal">gallon</option>
<option value="ml">milliliter</option>
<option value="l">liter</option>

<!-- Weight -->
<option value="can">can</option>
<option value="oz">ounce</option>
<option value="lb">pound</option>
<option value="mg">milligram</option>
<option value="g">gram</option>
<option value="kg">kilogram</option>

<!-- Other common units -->
<option value="dash">dash</option>
<option value="pinch">pinch</option>
<option value="sprig">sprig</option>
<option value="stick">stick (butter)</option>
<option value="clove">clove (garlic)</option>
<option value="slice">slice</option>
{% endmacro %}
